(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-430fc477"],{2606:function(e,t,a){"use strict";var s=a("3157"),l=a.n(s);l.a},3157:function(e,t,a){},"88b3e":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-container",[a("el-header",[e._v(" 上传SAR影像 ")]),a("el-main",[a("el-row",{attrs:{gutter:15}},[a("el-col",{class:{"col-17-step2":2===e.step},attrs:{span:18}},[a("el-card",{directives:[{name:"show",rawName:"v-show",value:1===e.step,expression:"step===1"}],attrs:{shadow:"hover"}},[a("el-form",{attrs:{"label-position":"right","label-width":"20%"}},[a("el-form-item",{attrs:{label:"水库名称"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.selectedReservoir,callback:function(t){e.$set(e.form,"selectedReservoir",t)},expression:"form.selectedReservoir"}},e._l(e.reservoirList,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.name}},[e._v(" "+e._s(t.name)+" ")])})),1)],1),a("el-form-item",{attrs:{label:"卫星名称"}},[a("el-input",{staticStyle:{width:"60%"},attrs:{placeholder:"请输入卫星名称"},model:{value:e.form.satelliteName,callback:function(t){e.$set(e.form,"satelliteName",t)},expression:"form.satelliteName"}})],1),a("el-form-item",{attrs:{label:"卫星周期"}},[a("el-input",{staticStyle:{width:"60%"},attrs:{placeholder:"请输入周期"},model:{value:e.form.cycle,callback:function(t){e.$set(e.form,"cycle",t)},expression:"form.cycle"}})],1),a("el-form-item",{attrs:{label:"日期"}},[a("el-date-picker",{attrs:{type:"date",placeholder:"请输入日期"},model:{value:e.form.date,callback:function(t){e.$set(e.form,"date",t)},expression:"form.date"}})],1),a("el-form-item",{attrs:{label:"分割算法"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.form.cutAlgo,callback:function(t){e.$set(e.form,"cutAlgo",t)},expression:"form.cutAlgo"}},e._l(e.cutAlgoList,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.name}},[e._v(" "+e._s(t.name)+" ")])})),1)],1),a("el-form-item",{attrs:{label:"左上角经纬度"}},[a("el-input",{staticStyle:{width:"60%"},attrs:{placeholder:'以空格分隔经纬度，例如"111.01 32.97"'},on:{input:e.stepOneSetTest},model:{value:e.form.topLeft,callback:function(t){e.$set(e.form,"topLeft",t)},expression:"form.topLeft"}})],1),a("el-form-item",{attrs:{label:"右下角经纬度"}},[a("el-input",{staticStyle:{width:"60%"},attrs:{placeholder:'以空格分隔经纬度，例如"111.75 32.93"'},on:{input:e.stepOneSetTest},model:{value:e.form.lowerRight,callback:function(t){e.$set(e.form,"lowerRight",t)},expression:"form.lowerRight"}})],1),a("el-form-item",{attrs:{label:"选择图像文件"}},[a("el-upload",{staticClass:"upload-drag-list",attrs:{drag:"",action:"",limit:1,"auto-upload":!1,"show-file-list":!0,"on-change":e.handleFileChanges,"on-remove":e.handleFileChanges,multiple:!1,"file-list":e.fileList,"list-type":"picture"}},[a("i",{staticClass:"el-icon-upload"}),a("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),a("em",[e._v("点击上传")])])])],1),a("el-button",{attrs:{disabled:e.stepOneClickNextDisable},domProps:{textContent:e._s(e.stepOneNextText)},on:{click:e.stepOneClickNext}})],1)],1),a("el-card",{directives:[{name:"show",rawName:"v-show",value:2===e.step,expression:"step===2"}],staticClass:"el-card-step2",attrs:{shadow:"hover","body-style":{flex:"1",display:"flex",flexDirection:"column",padding:"0"}}},[a("div",{staticStyle:{flex:"1",position:"relative"}},[2===e.step?a("el-image",{staticClass:"el-image-step2",attrs:{src:"/api/upload/sar/getImageData?type=o",fit:"contain"}}):e._e(),2===e.step?a("el-image",{staticClass:"el-image-n el-image-step2",style:{opacity:.01*e.opacity},attrs:{src:"/api/upload/sar/getImageData?type=n",fit:"contain"}}):e._e()],1),a("div",{style:{display:"flex",alignItems:"center",margin:"10px",flexBasis:"40px"}},[a("span",{style:{opacity:1-.01*e.opacity*.8,transition:".1s"}},[e._v("处理前")]),a("div",{staticStyle:{flex:"1","margin-left":"20px","margin-right":"20px"}},[a("el-slider",{attrs:{"show-tooltip":!1},model:{value:e.opacity,callback:function(t){e.opacity=t},expression:"opacity"}})],1),a("span",{style:{opacity:.01*e.opacity*.8+.2,transition:".1s"}},[e._v("处理后")]),a("div",{staticStyle:{flex:"5"}},[a("el-button",{staticStyle:{"margin-bottom":"0"},on:{click:e.stepTwoClickNext}},[e._v(" 下一步 ")]),a("el-button",{staticStyle:{"margin-bottom":"0"},on:{click:e.stepTwoClickBack}},[e._v(" 上一步 ")])],1)])]),a("el-card",{directives:[{name:"show",rawName:"v-show",value:3===e.step,expression:"step===3"}],attrs:{shadow:"hover"}},[a("el-row",{staticStyle:{display:"flex"}},[a("el-col",{attrs:{span:4}},[3===e.step?a("el-image",{staticStyle:{border:"dotted #909399"},attrs:{src:"/api/upload/sar/getImageData?type=n",fit:"contain","preview-src-list":["/api/upload/sar/getImageData?type=n"]}}):e._e()],1),a("el-col",{staticStyle:{flex:"1",display:"flex","align-items":"center","margin-left":"1em"},attrs:{span:20}},[e._v(" 从图像中提取出的水域面积为： "),a("span",{staticStyle:{color:"#00b776"},domProps:{textContent:e._s(e.waterArea)}})])],1),a("el-button",{attrs:{type:"success"},on:{click:e.stepThreeClickSave}},[e._v(" 确认并保存 ")]),a("el-button",{on:{click:e.stepTwoClickBack}},[e._v(" 上一步 ")])],1),a("el-card",{directives:[{name:"show",rawName:"v-show",value:4===e.step,expression:"step===4"}],attrs:{shadow:"hover"}},[a("i",{staticClass:"el-icon-success"}),e._v(" 数据已保存 "),a("el-button",{on:{click:e.stepFourClickWatchData}},[e._v(" 查看数据 ")])],1)],1),a("el-col",{attrs:{span:6}},[a("el-card",{attrs:{shadow:"hover"}},[a("el-steps",{attrs:{direction:"vertical",active:e.step-1}},[a("el-step",{attrs:{title:"上传文件",description:"输入信息，上传图像文件"}}),a("el-step",{attrs:{title:"确认图像处理结果",description:"检查图像是否被正确处理"}}),a("el-step",{attrs:{title:"水域面积提取",description:"确认水域面积提取结果"}}),a("el-step",{attrs:{title:"上传完成"}})],1)],1)],1)],1)],1)],1)],1)},l=[],i={name:"uploadSarImage",data:function(){return{fileList:[],reservoirList:[],cutAlgoList:[{id:1,name:"FCM"},{id:2,name:"OTSU"},{id:3,name:"ACM"}],form:{selectedReservoir:"",satelliteName:"",cycle:"",date:"",cutAlgo:"",topLeft:"",lowerRight:""},selectRadar:{index:"",lng:"",lat:"",level:""},uploadPercentage:0,resultList:[],step:1,pointer:{url:"/marker.png",size:{width:50,height:50}},centerPoint:{lng:"",lat:""},zoom:15,opacity:100,stepOneNextText:"下一步",uploading:!1,waterArea:""}},computed:{stepOneClickNextDisable:function(){return""===this.form.selectedReservoir||""===this.form.satelliteName||""===this.form.cycle||""===this.form.date||""===this.form.cutAlgo||""===this.form.topLeft||""===this.form.lowerRight||0===this.fileList.length||this.uploading}},methods:{handleFileChanges:function(e,t){this.fileList=t},stepOneClickNext:function(){var e=this;this.uploading=!0,this.stepOneNextText="正在处理数据";for(var t=new FormData,a=0;a<this.fileList.length;a++)t.append("sarFile",this.fileList[a].raw);this.axios({url:"/api/upload/sar/sarFile",method:"post",data:t,headers:{"Content-Type":"multipart/form-data;charset=utf-8"},onUploadProgress:function(t){e.uploadPercentage=t.loaded/t.total*100|0}}).then((function(t){200===t.status?(e.step++,e.stepOneNextText="下一步",e.uploading=!1):console.log("error")}))},stepOneSetTest:function(){"//"!==this.form.topLeft&&"//"!==this.form.lowerRight||(this.form.topLeft="111.000 33.070",this.form.lowerRight="111.775 32.447")},stepTwoClickBack:function(){this.step--},stepTwoClickNext:function(){var e=this,t=new FormData;t.append("reservoirName",this.form.selectedReservoir),t.append("satelliteName",this.form.satelliteName),t.append("cycle",this.form.cycle),t.append("date",this.form.date),t.append("cutAlgo",this.form.cutAlgo),t.append("topLeft",this.form.topLeft),t.append("lowerRight",this.form.lowerRight),this.axios.post("/api/upload/sar/getArea",t).then((function(t){200===t.status?(e.waterArea=1e-6*t.data+"/km²",e.step++):console.log("error")}))},stepThreeClickSave:function(){var e=this,t=new FormData;t.append("reservoirName",this.form.selectedReservoir),t.append("date",this.form.date),t.append("cutAlgo",this.form.cutAlgo),this.axios.post("/api/upload/sar/saveArea",t).then((function(t){200===t.status?(e.waterArea=t.data,e.step++):console.log("error")}))},stepFourClickWatchData:function(){this.$router.push("/dm")}},mounted:function(){var e=this;this.axios.get("/api/reservoirInfo/reservoir").then((function(t){200===t.status?e.reservoirList=t.data:console.log("error"),e.form.selectedReservoir=e.$store.getters.getReservoir}))}},o=i,r=(a("2606"),a("2877")),n=Object(r["a"])(o,s,l,!1,null,"48cf439b",null);t["default"]=n.exports}}]);
//# sourceMappingURL=chunk-430fc477.315e818c.js.map