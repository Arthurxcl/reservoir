(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1065d9a2"],{"14df":function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-container",[s("el-header",[e._v(" 上传实测水位 ")]),s("el-main",[s("el-row",{attrs:{gutter:15}},[s("el-col",{attrs:{span:18}},[s("el-card",{directives:[{name:"show",rawName:"v-show",value:1===e.step,expression:"step===1"}],attrs:{shadow:"hover"}},[s("el-form",{attrs:{"label-width":"20%"}},[s("el-form-item",{attrs:{label:"水库名称"}},[s("el-select",{attrs:{placeholder:"请选择"},model:{value:e.selectedReservoir,callback:function(t){e.selectedReservoir=t},expression:"selectedReservoir"}},e._l(e.reservoirList,(function(t){return s("el-option",{key:t.id,attrs:{label:t.name,value:t.name}},[e._v(" "+e._s(t.name)+" ")])})),1)],1),s("el-form-item",{attrs:{label:"选择文件"}},[s("el-upload",{staticClass:"upload-drag-list",attrs:{drag:"",action:"",limit:1,"auto-upload":!1,"show-file-list":!0,"on-change":e.handleFileChanges,"on-remove":e.handleFileChanges,multiple:!1,"file-list":e.fileList}},[s("i",{staticClass:"el-icon-upload"}),s("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),s("em",[e._v("点击上传")])])])],1),s("el-button",{attrs:{disabled:e.stepOneClickNextDisable},on:{click:e.stepOneClickNext}},[e._v(" 下一步 ")])],1)],1),s("el-card",{directives:[{name:"show",rawName:"v-show",value:2===e.step,expression:"step===2"}],attrs:{shadow:"hover"}},[e._v(" 从文件中提取到以下数据： "),s("el-table",{attrs:{data:e.resultList,border:!0}},[s("el-table-column",{attrs:{prop:"siteName",label:"站名"}}),s("el-table-column",{attrs:{prop:"waterLevel",label:"水位"}}),s("el-table-column",{attrs:{prop:"measuredStorage",label:"蓄水量"}}),s("el-table-column",{attrs:{prop:"date",label:"日期"}})],1),s("el-button",{attrs:{type:"success"},on:{click:e.stepTwoClickSave}},[e._v(" 确认并保存 ")]),s("el-button",{on:{click:e.stepTwoClickBack}},[e._v(" 上一步 ")])],1),s("el-card",{directives:[{name:"show",rawName:"v-show",value:3===e.step,expression:"step===3"}],attrs:{shadow:"hover"}},[s("i",{staticClass:"el-icon-success"}),e._v(" 数据已保存 "),s("el-button",{on:{click:e.stepThreeClickWatchData}},[e._v(" 查看数据 ")])],1)],1),s("el-col",{attrs:{span:6}},[s("el-card",{attrs:{shadow:"hover"}},[s("el-steps",{attrs:{direction:"vertical",active:e.step-1}},[s("el-step",{attrs:{title:"上传文件",description:"选择目标水库，上传实测水位Excel文件"}}),s("el-step",{attrs:{title:"确认数据",description:"确认数据提取结果"}}),s("el-step",{attrs:{title:"上传完成"}})],1)],1)],1)],1)],1)],1)],1)},l=[],r={name:"uploadMeasuredLevel",data:function(){return{fileList:[],reservoirList:[],selectedReservoir:"",resultList:[],step:1}},computed:{stepOneClickNextDisable:function(){return""===this.selectedReservoir||0===this.fileList.length}},methods:{handleFileChanges:function(e,t){this.fileList=t},stepOneClickNext:function(){var e=this,t=new FormData;t.append("reservoirName",this.selectedReservoir),t.append("measuredFile",this.fileList[0].raw),this.axios({url:"/upload/measured",method:"post",data:t,headers:{"Content-Type":"multipart/form-data;charset=utf-8"}}).then((function(t){if(200===t.status){e.resultList=t.data;for(var s=0;s<e.resultList.length;s++)console.log(new Date(parseInt(e.resultList[s].date))),e.resultList[s].date=new Date(parseInt(e.resultList[s].date)).toLocaleDateString();e.step++}}))},stepTwoClickBack:function(){this.step--},stepTwoClickSave:function(){var e=this;this.axios.get("/upload/measured/save").then((function(t){200===t.status?e.step++:console.log("error")}))},stepThreeClickWatchData:function(){this.$router.push("/dm")}},mounted:function(){var e=this;this.axios.get("/api/reservoirInfo/reservoir").then((function(t){200===t.status?e.reservoirList=t.data:console.log("error")}))}},i=r,o=(s("f9d7"),s("2877")),n=Object(o["a"])(i,a,l,!1,null,"03d3d16b",null);t["default"]=n.exports},9060:function(e,t,s){},f9d7:function(e,t,s){"use strict";var a=s("9060"),l=s.n(a);l.a}}]);
//# sourceMappingURL=chunk-1065d9a2.a0fbb352.js.map